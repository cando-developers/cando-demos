(setf *default-pathname-defaults* #P"/Users/meister/Development/cando/extensions/cando/src/tests/dynamics/setup/")

(QUICKLISP-CLIENT:QUICKLOAD :FEP)
(COMMON-LISP:IN-PACKAGE :CANDO-USER)
(LEAP:SETUP-AMBER-PATHS)
(LEAP:SOURCE "leaprc.water.tip3p")
(LEAP:LOAD-OFF "solvents.lib")
(LEAP:LOAD-OFF "atomic_ions.lib")
(LEAP:LOAD-ATOM-TYPE-RULES "ATOMTYPE_GFF.DEF")
(LEAP:SOURCE "leaprc.ff14SB.redq")
(LEAP:SOURCE "leaprc.gaff")
(COMMON-LISP:DEFPARAMETER FEP::*FEPS* (FEP:LOAD-FEPS "postcharge/feps.cando"))
(COMMON-LISP:DEFPARAMETER FEP::*RECEPTOR*
  (COMMON-LISP:FIRST (FEP:RECEPTORS FEP::*FEPS*)))
(COMMON-LISP:DEFPARAMETER FEP::*SIDE-NAME* :COMPLEX)
(COMMON-LISP:DEFPARAMETER FEP::*MORPH*
  (FEP::FIND-MORPH-WITH-NAME "AA-AB" FEP::*FEPS*))
(COMMON-LISP:DEFPARAMETER FEP::*TARGET* (FEP:TARGET FEP::*MORPH*))
(COMMON-LISP:DEFPARAMETER FEP::*SYSTEM*
  (CANDO:COMBINE (CHEM:MATTER-COPY (fep::molecule FEP::*target*))
                 (CHEM:MATTER-COPY FEP::*RECEPTOR*)))
(LEAP:SOLVATE-BOX FEP::*SYSTEM*
                  (LEAP.CORE:LOOKUP-VARIABLE (FEP::SOLVENT-BOX FEP::*FEPS*))
                  (FEP::SOLVENT-BUFFER FEP::*FEPS*)
                  (FEP::SOLVENT-CLOSENESS FEP::*FEPS*))
(LEAP.ADD-IONS:ADD-IONS FEP::*SYSTEM* :|Cl-| 0)
(CANDO:SAVE-MOL2 FEP::*SYSTEM* (COMMON-LISP:ENSURE-DIRECTORIES-EXIST "complex.mol2"))
(LEAP.TOPOLOGY:SAVE-AMBER-PARM-FORMAT FEP::*SYSTEM* (truename "complex.parm7") (truename "complex.rst7"))
